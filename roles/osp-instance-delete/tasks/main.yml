---
# tasks file for roles/osp-instance-delete
  - name: Fetch Instance Info
    os_server_facts:
      cloud: ospcloud
      region_name: RegionOne
    register: openstack_info

#  - debug:
#      var: openstack_info.ansible_facts.openstack_servers.host_id
#  - debug:
#      var: openstack_info.ansible_facts


    
  - name: Delete instances
    os_server:
      cloud: ospcloud
      name: "{{ item.name }}"
      state: absent
    loop: "{{ openstack_info.ansible_facts.openstack_servers }}"
    become: yes